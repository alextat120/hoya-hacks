var async = require("async");

var pastec = require("./")({
    server: "new.ukiyo-e.org:4212"
});

var fileMap = {};
var files = process.argv.slice(2);

files.forEach(function(file, i) {
    fileMap[i + 1] = file;
});

async.eachLimit(Object.keys(fileMap), 1, function(id, callback) {
    console.log("Adding", id, fileMap[id]);
    pastec.add(fileMap[id], id, callback);
}, function() {
    pastec.saveIndex("/home/pastec/index.dat", function() {
        console.log("DONE");
    });
});
